:script "/Users/r_tyler/Music/ableton_songs/toolz.tidal"

:script "/Users/r_tyler/Music/ableton_songs/pigments_midi_map.tidal"

:script "/Users/r_tyler/Music/ableton_songs/breakz.tidal"

let ssss = "0 7 11 16"

let piano sss =   slow (32.0/4) $ stack [
         n (tScale sss $ "-4 ~!5 1 3 -3 ~ -2 ~!2 3 2 4 -2 ~ -1 ~!2 4 3 5 -1 ~ 1 ~!3 5 4 6 2 ~!3 6 ~ 5 7 1 ~!3 5 4 6 -2 0 ~!3 4 3 5 -3 -1 ~!3 3 2 ~ 4 ~ -2 ~!2 2 ~ 1 3 -3 ~ -2 ~!2 3 2 4 0 ~!3 4 3 5 ~ 1 ~!3 5 4 6 ~ 2 ~!3 6 5 7 ~ 1 ~!3 5 4 6 ~ 0 ~!3 4 3 5 ~ -1 ~!3 3 2 4" )
         # amp "0.46 0!5 0.5 0.63 0.52 0.0 0.49 0!2 0.54 0.55 0.65 0.48 0.0 0.57 0!2 0.46 0.5!2 0.66 0.0 0.43 0!3 0.35 0.5 0.57 0.52 0!3 0.53 0.0 0.47 0.76 0.42 0!3 0.42 0.46 0.63 0.52 0.4 0!3 0.57 0.54 0.66 0.46 0.53 0!3 0.46 0.5 0.0 0.62 0.0 0.45 0!2 0.46 0.0 0.46 0.44 0.6 0.0 0.5 0!2 0.5 0.52 0.54 0.43 0!3 0.54 0.5 0.58 0.0 0.41 0!3 0.45 0.49 0.65 0.0 0.45 0!3 0.46 0.5 0.61 0.0 0.43 0!3 0.46 0.48 0.67 0.0 0.46 0!3 0.5 0.53 0.55 0.0 0.43 0!3 0.54 0.52 0.71"
         # legato "5.0 0!5 1.0 2.0 6.0 0.0 4.0 0!2 1.0!2 3.0 7.0 0.0 5.0 0!2 1.0!2 2.0 6.0 0.0 4.0 0!3 1.0 0.0 1.0 5.0 0!3 1.0 0!2 1.0 5.0 0!3 1.0!2 2.0 7.0 6.0 0!3 1.0 2.0!2 6.0 5.0 0!3 1.0 2.0 0.0 1.0 0.0 5.0 0!2 1.0 0!2 1.0 5.0 0.0 3.0 0!2 1.0 0.0 1.0 5.0 0!3 1.0!2 2.0 0.0 5.0 0!3 2.0 1.0 2.0 0.0 5.0 0!3 1.0!2 2.0 0.0 5.0 0!3 1.0!3 0.0 5.0 0!3 1.0!2 2.0 0.0 5.0 0!3 1.0!3",
         n (tScale sss $ "~ -2 ~!7 -1 ~ 0 ~!5 0 ~ 1 ~!7 0 ~!4 0 ~!2 1 ~!4 -1 ~!2 0 ~!7 -1 ~!7 -2 ~!5 -4 ~ -3 ~!5 -1 ~!2 0 ~!4 -2 ~ -1 ~!4 -1 ~ 0 ~!5 0 ~ 1 ~!5 -1 ~ 0 ~!5 -2 ~ -1 ~!5 -3 ~ -2 ~!5" )
         # amp "0.0 0.47 0!7 0.49 0.0 0.46 0!5 0.43 0.0 0.43 0!7 0.54 0!4 0.53 0!2 0.39 0!4 0.65 0!2 0.45 0!7 0.42 0!7 0.43 0!5 0.55 0.0 0.46 0!5 0.46 0!2 0.46 0!4 0.6 0.0 0.53 0!4 0.63 0.0 0.5 0!5 0.55 0.0 0.4 0!5 0.54 0.0 0.46 0!5 0.46 0.0 0.5 0!5 0.43 0.0 0.46 0!5"
         # legato "0.0 4.0 0!7 5.0 0.0 4.0 0!5 6.0 0.0 5.0 0!7 3.0 0!4 6.0 0!2 4.0 0!4 6.0 0!2 4.0 0!7 4.0 0!7 3.0 0!5 5.0 0.0 3.0 0!5 5.0 0!2 3.0 0!4 5.0 0.0 3.0 0!4 6.0 0.0 4.0 0!5 6.0 0.0 4.0 0!5 6.0 0.0 4.0 0!5 5.0 0.0 4.0 0!5 6.0 0.0 5.0 0!5",
         n (tScale sss $ "~!2 -3 ~!9 1 ~!7 2 ~!7 2 ~!7 3 ~!6 2 ~!7 1 ~!8 0 ~!7 -1 ~!8 1 ~!6 1 ~!6 2 ~!7 3 ~!7 2 ~!7 1 ~!7 0 ~!4" )
         # amp "0!2 0.49 0!9 0.53 0!7 0.51 0!7 0.4 0!7 0.4 0!6 0.36 0!7 0.43 0!8 0.47 0!7 0.5 0!8 0.42 0!6 0.42 0!6 0.39 0!7 0.49 0!7 0.35 0!7 0.39 0!7 0.5 0!4"
         # legato "0!2 3.0 0!9 1.0 0!7 1.0 0!7 3.0 0!7 2.0 0!6 3.0 0!7 3.0 0!8 2.0 0!7 4.0 0!15 3.0 0!6 4.0 0!7 2.0 0!7 2.0 0!7 2.0 0!7 3.0 0!4",
         n (tScale sss $ "~!3 -1 ~!25 3 ~!7 4 ~!6 3 ~!7 2 ~!8 1 ~!7 0 ~!14 2 ~!7 3 ~!7 4 ~!7 3 ~!7 2 ~!7 1 ~!3" )
         # amp "0!3 0.43 0!25 0.52 0!7 0.5 0!6 0.5 0!7 0.52 0!8 0.46 0!7 0.54 0!14 0.46 0!7 0.54 0!7 0.52 0!7 0.47 0!7 0.46 0!7 0.37 0!3"
         # legato "0!3 4.0 0!25 1.0 0!14 1.0 0!7 1.0 0!31 1.0 0!7 1.0 0!7 1.0 0!7 1.0 0!7 1.0 0!7 1.0 0!3",
         n (tScale sss $ "~!4 0 ~!123" )
         # amp "0!4 0.65 0!123"
         # legato "0!4 1.0 0!123",
         n (tScale sss $ "~!5 2 ~!122" )
         # amp "0!5 0.49 0!122"
         # legato "0!5 1.0 0!122"
         ] 


d1 $ cat[ piano ssss, piano sss1, piano sss2, piano sss3] 


do
  -- resetCycles
  let arp_p2 = "-12 3 5 7 10"
      --arp_p1 = "-12 3 5 7 10"
      -- arp_p = "0 7 15"
      -- arp_p = "0 8 13 18 26"
      arp_p = (tScale "0 2 4 7 9 11" ("-7  2 3 4 6" |- "-1"))
      --deg_p = "[-3 2 -4 2]/4"
      deg_p = "[0]/4"
      ssss = (tScale' 12 arp_p ("0 2 3 4" |+ deg_p)) 
      sss1 = (tScale' 12 arp_p ("0 2 3 4" |+ 2 |+ deg_p))
      sss2 = (tScale' 12 arp_p ("2 3 4 " |+ 4 |+ deg_p ))
      sss3 = (tScale' 12 arp_p ("2 3 4 " |- 2 |+ deg_p))
  d1 $ (|+ n (slow "[1 2 4 2]/3" $ "[0 -12 0 12]")) $
       (|* legato "[<1.5 2> 0.3 [0.8 0.2] 0.4]/8") $
       slow 1.75 $
       -- slow 4 $ slow ("1.5 1.49 1.51 1.485" |/ 4.5) $
       -- sliceDiv 12 15 16 "<4 2>" $
       (|+ n "[0 5 0 7]/16") $ 
       stack [
       slow 2 $ fast 2 $ bite 4 "0 1 [2 2] 3" $ mask "t f f <t f> " $ piano ssss # m 1,
      r "0.001" $ mask "f f f t " $ bite 3 "0 2 1" $
         piano sss1 # m 2,
       r "0.0013" $ fast "[1 1  2]/5" $ mask "<f t> f t f " $
         (|- n "[0 12 0 12]/2") $ bite 5 "0 2 1 4 3" $
         piano sss1 # m 3,
      r "0.0015" $ mask "f t f f " $ slow 3 $ bite 2 "0 1!3" $
         piano sss3 # m 4 ]

d2 $ mb (-0.000001) (0.00001) (slow 2 $ slow "<64 32>/4" $  sine) # m "[1,2,3,4]" 

d2 silence



