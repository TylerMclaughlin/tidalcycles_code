let asdf = slow (8/4) $ stack [
     n "c3 d3 f3 d3 c3 g3 d3!2 c3 d3 f3 d3 c3 g3 d3!2 c3 d3 f3 d3 c3 g3 d3!2 c3 e3 f3 e3 c3 g3 d3 c3"
     # amp "1.0 0.01 0.98 0.27 1.0!2 0.27 0.61 1.0 0.01 0.98 0.27 1.0!2 0.27 0.61 1.0 0.01 0.98 0.27 1.0!2 0.27 0.61 1.0 0.2 0.98 0.01 1.0!2 0.27 0.01"
     # legato "0!31 1.0",
     n "fs3 ~ fs3 cs3 ds3 ~ f3 ~ fs3 ~ fs3 cs3 ds3 ~ f3 ~ fs3 ~ fs3 cs3 ds3 ~ f3 ~ e3 d3 fs3 d3 ds3 cs3 f3 d3"
     # amp "1.0 0.0 0.31 1.0!2 0.0 0.98 0.0 1.0 0.0 0.31 1.0!2 0.0 0.98 0.0 1.0 0.0 0.31 1.0!2 0.0 0.98 0.0 0.98 0.01 0.31 0.27 1.0 0.46 0.98 0.61"
     # legato "0!32",
     n "cs3 ~!7 cs3 ~!7 cs3 ~!7 fs3 ~!2 cs3 ~!3 cs3"
     # amp "0.46 0!7 0.46 0!7 0.46 0!7 1.0 0!2 1.0 0!3 0.06"
     # legato "0!32",
     n "~!24 cs3 ~!7"
     # amp "0!24 0.46 0!7"
     # legato "0!32"
     ]

d1 $ shuffle 8 $  (|+ n "[0 0 0 0]*4") $ asdf # m 1

let ssss p = select p [n "[0, 3, 7, 10]", n "[3, 6, 10, 13]", n "[8, 10, 11, 18]", n "[1, 5, 8, 12]"] 


d1 $ struct "t(15,16)" $ ssss "0.4 0.8" # m 1 

d1 $ struct "t(15,16)" $ ssss ("0.4 0.8" |+ 0.4) # m 1 

d1 $ struct "t(15,16)" $ ssss ("0 0.4 0.8 1.2"  ) # m 1 

-- yessss
d1 $ struct "t(15,16)" $ ssss ("0 .. 3" |/ "3"  ) # m 1 

-- tesst with 16 chords gorgeous_piano.mid
let gp p = select p [n "[53, 62, 60, 57, 72, 64, 67, 69]", n "[67, 55, 64, 52, 62, 60, 71, 59]", n "[50, 53, 57, 60, 64, 67, 74]", n "[48, 53, 57, 64, 62, 69, 76]", n "[47, 52, 55, 62, 67, 74, 81]", n "[48, 55, 57, 67, 64, 71, 76, 79]", n "[50, 53, 57, 62, 69, 64, 74, 76]", n "[52, 55, 59, 67, 64, 72, 74]", n "[53, 57, 60, 67, 62, 69, 76, 79]", n "[52, 55, 59, 60, 62, 67, 72, 74]", n "[50, 57, 60, 62, 65, 67, 76]", n "[65, 67, 76, 62]", n "[48, 55, 59, 60, 62, 69, 74, 76]", n "[48, 53, 57, 62, 64, 67, 69, 72]", n "[47, 52, 55, 62, 64, 67]", n "[47, 52, 55, 62, 67, 74, 64, 76]"]


let gp p = select p [n "[-7, 2, 0, -3, 12, 4, 7, 9]", n "[7, -5, 4, -8, 2, 0, 11, -1]", n "[-10, -7, -3, 0, 4, 7, 14]", n "[-12, -7, -3, 4, 2, 9, 16]", n "[-13, -8, -5, 2, 7, 14, 21]", n "[-12, -5, -3, 7, 4, 11, 16, 19]", n "[-10, -7, -3, 2, 9, 4, 14, 16]", n "[-8, -5, -1, 7, 4, 12, 14]", n "[-7, -3, 0, 7, 2, 9, 16, 19]", n "[-8, -5, -1, 0, 2, 7, 12, 14]", n "[-10, -3, 0, 2, 5, 7, 16]", n "[5, 7, 16, 2]", n "[-12, -5, -1, 0, 2, 9, 14, 16]", n "[-12, -7, -3, 2, 4, 7, 9, 12]", n "[-13, -8, -5, 2, 4, 7]", n "[-13, -8, -5, 2, 7, 14, 4, 16]"]


d1 $ off (0.25) (|+ n 2) $ struct "t(15, 37)" $ gp "0 0.25" # m 1

-- :)
d1 $ struct "t!16" $ gp ("0 .. 15" |/ 16) # m 1

d1 $ struct "t!16" $ slow 4 $ gp ("0 .. 15" |/ 16) # m 1

-- vibe shift
d1 $ (|+ nTake "upp" [0,12]) $ struct "t!16" $ slow 4 $ gp ("0 .. 15" |/ 16) # m 1

let groov = groove 8 "0 0.02"

d1 $ groov $ (|+ nT4r "upp" 1 "0 12 0 0 12 12 0 12" ) $ struct "t!16" $ slow 4 $ gp ("0 .. 15" |/ 16) # m 1

d2 $ drumz $ n "0 0 0 0" # m 2

d2 $ groov $ drumz $ n "0 8 0 8 0 8 0 8" # m 2

d2 $ groov $ drumz $ struct "t*16" $ nT "kickHat" 2 "0 8 0 8 0 8 0 8" # m 2

d3 $ groov $ drumz $  n "~ ~ 10 ~ ~ 10 ~ ~" # m 2







--- old

d1 $ fast 4 $ ssss "0.3 0.4"  # m 1


d1 $ drumz $ off 0.25 (|+ n 12) $ select "0 1 2 3" [n "0 1 2 3", n "4 5 6 7"] # m 1

d1 $ (|+ nTake "r" (concatMap (replicate 4) [0,1, 7, 8, 2, 3])) $ cat [ struct "t(5,16)" $ n "[0, 4, 7, 11]", struct "t(5,16)" $ n "[2, 5, 8, 12]"] # m 1

d2 $ struct "t(9, 17)" $ cat [n "[0, 3, 7, 10]", n "[2, 5, 9, 12]"] # m 1

d2 $ (|+ nTake "r" (concatMap (replicate 4) [0,0, 0, 7])) $ struct "t(9, 17)" $ cat [n "[0, 3, 7, 10]", n "[2, 5, 9, 12]"] # m 1


d2 $ ncat [(0.25, n "[0, 3, 7, 10]*16") , (0.25, n "[2, 5, 9, 12]*16")] # m 1

d2 $ mask "t(3,8)" $ cat [fast 8 a, b] # m 1


d1 $ choose [a, b] # m 1

patternToList (irand 8)

 d1 $ fast 8 $ n (innerJoin $ choose [a,b]) # m 1


d1 $ fast 2 $ struct "t t t ~ ~ ~ ~ t t t " $ ncat [(2,  n a), (2,struct "t(9, 16)"$ n b), (2, n a), (2, n b)] # m 1


d1 $ n "[0, 4, 11]" # amp "[0.0, 0.5, 0.0]" # m 1

d1 $ every' (4) 3 (within (0.5, 1) (fast 8) ) $ n "0 2 4 9" # m 1
